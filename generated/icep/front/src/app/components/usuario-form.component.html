<div class="container">
  <div class="header">
    <h2>{{ isEditing ? 'Editar Usuário' : 'Novo Usuário' }}</h2>
  </div>

  <div *ngIf="loading" class="loading">Carregando...</div>
  <div *ngIf="error" class="error">{{ error }}</div>

  <div *ngIf="!loading" class="form-container">
    <form (ngSubmit)="save()">
      <div class="form-group">
        <label for="username">
          <svg class="label-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
          Username <span class="required">*</span>
        </label>
        <input type="text" id="username" [(ngModel)]="form.username" name="username" required [disabled]="isEditing" placeholder="Digite o username">
      </div>

      <div class="form-group">
        <label for="senha">
          <svg class="label-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
          </svg>
          Senha {{ isEditing ? '(deixe em branco para manter)' : '' }} <span class="required" *ngIf="!isEditing">*</span>
        </label>
        <input type="password" id="senha" [(ngModel)]="form.senha" name="senha" [required]="!isEditing" placeholder="{{ isEditing ? 'Deixe em branco para manter a senha atual' : 'Digite a senha' }}">
      </div>

      <div class="form-group">
        <label for="nome">
          <svg class="label-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
            <circle cx="9" cy="7" r="4"></circle>
            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
          </svg>
          Nome <span class="required">*</span>
        </label>
        <input type="text" id="nome" [(ngModel)]="form.nome" name="nome" required placeholder="Digite o nome completo">
      </div>

      <div class="form-group">
        <label for="email">
          <svg class="label-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
            <polyline points="22,6 12,13 2,6"></polyline>
          </svg>
          E-mail
        </label>
        <input type="email" id="email" [(ngModel)]="form.email" name="email" placeholder="Digite o e-mail">
      </div>

      <div class="form-group">
        <label for="perfilId">
          <svg class="label-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
          </svg>
          Perfil <span class="required">*</span>
        </label>
        <select id="perfilId" [(ngModel)]="form.perfilId" name="perfilId" required>
          <option value="">Selecione o perfil...</option>
          <option *ngFor="let perfil of perfis" [value]="perfil.id">{{ perfil.nome }}</option>
        </select>
      </div>

      <div class="form-group checkbox-group">
        <label class="checkbox-label">
          <input type="checkbox" [(ngModel)]="form.ativo" name="ativo">
          <span class="checkbox-custom"></span>
          <span class="checkbox-text">Usuário Ativo</span>
        </label>
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn-secondary" (click)="cancel()">
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
          <span>Cancelar</span>
        </button>
        <button type="submit" class="btn btn-primary" [disabled]="saving">
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" *ngIf="!saving">
            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
            <polyline points="17 21 17 13 7 13 7 21"></polyline>
            <polyline points="7 3 7 8 15 8"></polyline>
          </svg>
          <span>{{ saving ? 'Salvando...' : 'Salvar' }}</span>
        </button>
      </div>
    </form>
  </div>
</div>
